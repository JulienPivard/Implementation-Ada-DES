# vim: nofoldenable: list:
# PIVARD Julien
# Dernière modification : Mercredi 21 mars[03] 2018

###################
# Point d'entrée #
###################
.PHONY: all
all: $(CIBLECOMPILE)

MAKEFILE_V	= 1.5.0

# Vérifie si le binaire existe. Sinon il ajoute la cible de compilation
# en dépendance.
ifeq ($(wildcard $(EXECUTABLE)), )
    DEPEND	= $(CIBLECOMPILE)
else
    DEPEND	=
endif

###################
.PHONY: run
run: $(DEPEND)
	$(EXECUTABLE) $(ARGUMENTSAPPLI)

###################
.PHONY: version_makefile
version_makefile:
	@echo $(MAKEFILE_V)

###################
.PHONY: build
build:
	@echo
	@echo "┌───────────────────────────────────────────────────────────────┐"
	@echo "│                  Lancement de la compilation                  │"
	@echo "└───────────────────────────────────────────────────────────────┘"
	$(CC) -P$(GPR) $(OPTGPR)
	@echo "─────────────────────────────────────────────────────────────────"

###################
.PHONY: clean
clean:
	@echo "┌───────────────────────────────────────────────────────────────┐"
	@echo "│    Effacement des fichiers temporaire généré pour les tests   │"
	@echo "└───────────────────────────────────────────────────────────────┘"
	-$(RM) $(OPTRM) obj
	@echo "─────────────────────────────────────────────────────────────────"

###################
.PHONY: distclean
distclean: clean
	@echo "┌───────────────────────────────────────────────────────────────┐"
	@echo "│    Effacement des fichiers executable généré pour les tests   │"
	@echo "└───────────────────────────────────────────────────────────────┘"
	-$(RM) $(OPTRM) bin
	@echo "─────────────────────────────────────────────────────────────────"
ifneq ($(VARNOMFICHIER), )
	-$(RM) $(OPTRM) ./$(VARNOMFICHIER).rave.crypt \
	                ./$(VARNOMFICHIER).rave.crypt.rave.decrypt \
	                ./$(VARNOMFICHIER).sequ.crypt \
	                ./$(VARNOMFICHIER).sequ.crypt.sequ.decrypt \
	                ./$(VARNOMFICHIER).task.crypt \
	                ./$(VARNOMFICHIER).task.crypt.task.decrypt
endif

###################
.PHONY: compter
compter:
	find $(DOSSIERSRC) -type f | xargs cat | wc $(OPTCOMPTAGE)

###################
.PHONY: compterdetail
compterdetail:
	find $(DOSSIERSRC) -type f | xargs wc $(OPTCOMPTAGE)
